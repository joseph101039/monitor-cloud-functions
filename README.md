code implement:
reference doc: https://docs.google.com/document/d/1IG2GvS7IZT3H-fJOCk4ebJagBS1wPoX6KGkXlbxPq-8/edit?usp=sharing